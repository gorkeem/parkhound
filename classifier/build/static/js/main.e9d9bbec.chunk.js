(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{326:function(e,n,t){"use strict";t.r(n);var i,a,o,c,r,l,s,d,u,j,b,p,g,h,f,x,v,O,_,m,k,y,w,I,S,C,L,U,P,D,F,E,A,z,B,q=t(2),N=t(357),R=t(1),W=t.n(R),T=t(59),$=t.n(T),M=t(338),Q=t(27),K=t(23),Y=t(339),G=t(358),H=t(340),V=t(341),X=t(342),Z=t(24),J=t(108),ee=t(75),ne=t(30),te=t(9);function ie(){var e=Object(ne.a)(["\n    query PastLotOccupancy($id: Int!) {\n  past_lot_occupancy(\n    where: {parking_lot_id: {_eq: $id}}\n    order_by: {updated_at: asc}\n  ) {\n    occupied\n    updated_at\n  }\n}\n    "]);return ie=function(){return e},e}function ae(){var e=Object(ne.a)(["\n    query ParkingLotsByInstitutionID($id: Int!) {\n  institution_by_pk(id: $id) {\n    parking_lots(order_by: {id: asc}) {\n      ...ParkingLotCardInfo\n    }\n  }\n}\n    ",""]);return ae=function(){return e},e}function oe(){var e=Object(ne.a)(["\n    query ParkingLots {\n  parking_lot {\n    ...ParkingLotMapInfo\n  }\n}\n    ",""]);return oe=function(){return e},e}function ce(){var e=Object(ne.a)(["\n    query ParkingLotList($uid: Int!, $userLocation: NearbySpacesInput!) {\n  nearby_spaces(arg1: $userLocation) {\n    distance\n    parking_lot {\n      favorites(where: {user_id: {_eq: $uid}}) {\n        user_id\n      }\n      id\n      ...ParkingLotCardInfo\n    }\n  }\n}\n    ",""]);return ce=function(){return e},e}function re(){var e=Object(ne.a)(["\n    query ParkingLotDetailsByID($id: Int!) {\n  parking_lot_by_pk(id: $id) {\n    id\n    name\n    is_disabled\n    vacant_space {\n      vacant_count\n    }\n    location {\n      latitude\n      longitude\n    }\n    lot_rows {\n      id\n      parking_spaces(order_by: {id: asc}) {\n        ...ParkingSpaceInfo\n      }\n    }\n  }\n}\n    ",""]);return re=function(){return e},e}function le(){var e=Object(ne.a)(["\n    query ParkingLotBottomBarByID($id: Int!) {\n  parking_lot_by_pk(id: $id) {\n    id\n    name\n    location {\n      id\n      address\n      latitude\n      longitude\n    }\n    vacant_space {\n      vacant_count\n      capacity\n    }\n  }\n}\n    "]);return le=function(){return e},e}function se(){var e=Object(ne.a)(["\n    query NearbySpaces($userLocation: NearbySpacesInput!) {\n  nearby_spaces(arg1: $userLocation) {\n    distance\n    parking_lot {\n      ...ParkingLotCardInfo\n    }\n  }\n}\n    ",""]);return se=function(){return e},e}function de(){var e=Object(ne.a)(["\n    query Favorites($id: Int!) {\n  user_by_pk(id: $id) {\n    favorites {\n      parking_lot {\n        id\n      }\n    }\n  }\n}\n    "]);return de=function(){return e},e}function ue(){var e=Object(ne.a)(["\n    query DriversByInstitution($id: Int!) {\n  institution_by_pk(id: $id) {\n    user_institutions {\n      user_id\n      is_admin\n      user {\n        first_name\n        last_name\n        email\n      }\n    }\n  }\n}\n    "]);return ue=function(){return e},e}function je(){var e=Object(ne.a)(["\n    query AdminDashboard($id: Int!) {\n  user_by_pk(id: $id) {\n    user_institutions(where: {is_admin: {_eq: true}}) {\n      institution {\n        name\n        user_institutions_aggregate {\n          aggregate {\n            count\n          }\n        }\n        parking_lots {\n          name\n          vacant_space {\n            vacant_count\n          }\n        }\n        parking_lots_aggregate {\n          aggregate {\n            count\n          }\n        }\n      }\n    }\n  }\n}\n    "]);return je=function(){return e},e}function be(){var e=Object(ne.a)(["\n    mutation UpdateParkingSpace($id: Int!, $_set: parking_space_set_input) {\n  update_parking_space_by_pk(pk_columns: {id: $id}, _set: $_set) {\n    ...ParkingSpaceInfo\n  }\n}\n    ",""]);return be=function(){return e},e}function pe(){var e=Object(ne.a)(["\n    mutation UpdateParkingLot($id: Int!, $_set: parking_lot_set_input) {\n  update_parking_lot_by_pk(pk_columns: {id: $id}, _set: $_set) {\n    id\n    is_disabled\n  }\n}\n    "]);return pe=function(){return e},e}function ge(){var e=Object(ne.a)(["\n    mutation AddToFavorites($uid: Int!, $parking_lot_id: Int!) {\n  insert_favorites_one(object: {user_id: $uid, parking_lot_id: $parking_lot_id}) {\n    user_id\n    parking_lot_id\n    user {\n      favorites {\n        parking_lot {\n          id\n        }\n      }\n    }\n  }\n}\n    "]);return ge=function(){return e},e}function he(){var e=Object(ne.a)(["\n    fragment ParkingSpaceInfo on parking_space {\n  id\n  space_id\n  is_road\n  is_occupied\n  is_entry\n  is_exit\n  is_blank\n  is_disabled\n  is_driver_disabled_parking\n  rotation\n}\n    "]);return he=function(){return e},e}function fe(){var e=Object(ne.a)(["\n    fragment ParkingLotMapInfo on parking_lot {\n  id\n  location {\n    id\n    latitude\n    longitude\n  }\n  vacant_space {\n    vacant_count\n    capacity\n  }\n}\n    "]);return fe=function(){return e},e}function xe(){var e=Object(ne.a)(["\n    fragment ParkingLotCardInfo on parking_lot {\n  id\n  name\n  lot_image\n  vacant_space {\n    vacant_count\n  }\n}\n    "]);return xe=function(){return e},e}!function(e){e.FavoritesUserIdParkingLotIdUnique="favorites_user_id_parking_lot_id_unique"}(i||(i={})),function(e){e.ParkingLotId="parking_lot_id",e.UserId="user_id"}(a||(a={})),function(e){e.ParkingLotId="parking_lot_id",e.UserId="user_id"}(o||(o={})),function(e){e.InstitutionPkey="institution_pkey"}(c||(c={})),function(e){e.Id="id",e.Name="name"}(r||(r={})),function(e){e.Id="id",e.Name="name"}(l||(l={})),function(e){e.KnexMigrationsPkey="knex_migrations_pkey"}(s||(s={})),function(e){e.KnexMigrationsLockPkey="knex_migrations_lock_pkey"}(d||(d={})),function(e){e.Index="index",e.IsLocked="is_locked"}(u||(u={})),function(e){e.Index="index",e.IsLocked="is_locked"}(j||(j={})),function(e){e.Batch="batch",e.Id="id",e.MigrationTime="migration_time",e.Name="name"}(b||(b={})),function(e){e.Batch="batch",e.Id="id",e.MigrationTime="migration_time",e.Name="name"}(p||(p={})),function(e){e.LocationPkey="location_pkey"}(g||(g={})),function(e){e.Address="address",e.Id="id",e.Latitude="latitude",e.Longitude="longitude"}(h||(h={})),function(e){e.Address="address",e.Id="id",e.Latitude="latitude",e.Longitude="longitude"}(f||(f={})),function(e){e.LotRowPkey="lot_row_pkey"}(x||(x={})),function(e){e.Id="id",e.ParkingLotId="parking_lot_id"}(v||(v={})),function(e){e.Id="id",e.ParkingLotId="parking_lot_id"}(O||(O={})),function(e){e.Asc="asc",e.AscNullsFirst="asc_nulls_first",e.AscNullsLast="asc_nulls_last",e.Desc="desc",e.DescNullsFirst="desc_nulls_first",e.DescNullsLast="desc_nulls_last"}(_||(_={})),function(e){e.ParkingLotPkey="parking_lot_pkey"}(m||(m={})),function(e){e.Id="id",e.InstitutionId="institution_id",e.IsDisabled="is_disabled",e.LocationId="location_id",e.LotImage="lot_image",e.Name="name"}(k||(k={})),function(e){e.Id="id",e.InstitutionId="institution_id",e.IsDisabled="is_disabled",e.LocationId="location_id",e.LotImage="lot_image",e.Name="name"}(y||(y={})),function(e){e.ParkingSpacePkey="parking_space_pkey"}(w||(w={})),function(e){e.Id="id",e.IsBlank="is_blank",e.IsDisabled="is_disabled",e.IsDriverDisabledParking="is_driver_disabled_parking",e.IsEntry="is_entry",e.IsExit="is_exit",e.IsOccupied="is_occupied",e.IsRoad="is_road",e.IsSpace="is_space",e.LotRowId="lot_row_id",e.Rotation="rotation",e.SpaceId="space_id"}(I||(I={})),function(e){e.Id="id",e.IsBlank="is_blank",e.IsDisabled="is_disabled",e.IsDriverDisabledParking="is_driver_disabled_parking",e.IsEntry="is_entry",e.IsExit="is_exit",e.IsOccupied="is_occupied",e.IsRoad="is_road",e.IsSpace="is_space",e.LotRowId="lot_row_id",e.Rotation="rotation",e.SpaceId="space_id"}(S||(S={})),function(e){e.PastLotOccupancyPkey="past_lot_occupancy_pkey"}(C||(C={})),function(e){e.Id="id",e.Occupied="occupied",e.ParkingLotId="parking_lot_id",e.UpdatedAt="updated_at"}(L||(L={})),function(e){e.Id="id",e.Occupied="occupied",e.ParkingLotId="parking_lot_id",e.UpdatedAt="updated_at"}(U||(U={})),function(e){e.UserEmailUnique="user_email_unique",e.UserPkey="user_pkey"}(P||(P={})),function(e){e.UserInstitutionUserIdInstitutionIdUnique="user_institution_user_id_institution_id_unique"}(D||(D={})),function(e){e.InstitutionId="institution_id",e.IsAdmin="is_admin",e.UserId="user_id"}(F||(F={})),function(e){e.InstitutionId="institution_id",e.IsAdmin="is_admin",e.UserId="user_id"}(E||(E={})),function(e){e.CreatedAt="created_at",e.Email="email",e.FirstName="first_name",e.Id="id",e.LastName="last_name",e.Password="password",e.UpdatedAt="updated_at"}(A||(A={})),function(e){e.CreatedAt="created_at",e.Email="email",e.FirstName="first_name",e.Id="id",e.LastName="last_name",e.Password="password",e.UpdatedAt="updated_at"}(z||(z={})),function(e){e.Capacity="capacity",e.Id="id",e.VacantCount="vacant_count"}(B||(B={}));var ve=Object(te.gql)(xe()),Oe=Object(te.gql)(fe()),_e=Object(te.gql)(he()),me=Object(te.gql)(ge());var ke=Object(te.gql)(pe());var ye=Object(te.gql)(be(),_e);var we=Object(te.gql)(je());var Ie=Object(te.gql)(ue());var Se=Object(te.gql)(de());var Ce=Object(te.gql)(se(),ve);var Le=Object(te.gql)(le());var Ue=Object(te.gql)(re(),_e);function Pe(e){return te.useQuery(Ue,e)}var De=Object(te.gql)(ce(),ve);var Fe=Object(te.gql)(oe(),Oe);var Ee=Object(te.gql)(ae(),ve);var Ae=Object(te.gql)(ie());function ze(e){return te.useQuery(Ae,e)}var Be=t(129);function qe(){var e,n,t,i,a=(i={variables:{id:parseInt(localStorage.getItem("uid"))}},te.useQuery(we,i)).data,o=ze({variables:{id:1}}).data,c=ze({variables:{id:2}}).data,r=null===a||void 0===a||null===(e=a.user_by_pk)||void 0===e?void 0:e.user_institutions[0];return Object(q.jsxs)(M.a,{p:8,children:[Object(q.jsxs)(Y.a,{mb:4,children:[null===r||void 0===r?void 0:r.institution.name," Parking Lots"]}),Object(q.jsxs)(G.a,{justify:"center",spacing:16,bg:"white",p:4,boxShadow:"lg",rounded:"lg",children:[Object(q.jsxs)(H.a,{align:"center",children:[Object(q.jsx)(V.a,{as:Z.l,mr:1}),Object(q.jsx)(X.a,{mr:1,fontSize:"xl",fontWeight:"bold",children:null===r||void 0===r||null===(n=r.institution.user_institutions_aggregate.aggregate)||void 0===n?void 0:n.count}),"Registered Drivers"]}),Object(q.jsxs)(H.a,{align:"center",children:[Object(q.jsx)(V.a,{as:J.b,mr:1}),Object(q.jsx)(X.a,{mr:1,fontSize:"xl",fontWeight:"bold",children:null===r||void 0===r||null===(t=r.institution.parking_lots_aggregate.aggregate)||void 0===t?void 0:t.count}),"Parking Lots"]}),Object(q.jsxs)(H.a,{align:"center",children:[Object(q.jsx)(V.a,{as:ee.b,mr:1}),Object(q.jsx)(X.a,{mr:1,fontSize:"xl",fontWeight:"bold",children:null===r||void 0===r?void 0:r.institution.parking_lots.reduce((function(e,n){var t;return null==(null===n||void 0===n?void 0:n.vacant_space)?e:e+(null===(t=n.vacant_space)||void 0===t?void 0:t.vacant_count)}),0)}),"Vacant Spaces"]})]}),Object(q.jsxs)(G.a,{spacing:4,mt:4,justify:"center",children:[Object(q.jsxs)(H.a,{direction:"column",justify:"center",spacing:16,bg:"white",p:4,boxShadow:"lg",rounded:"lg",w:"600px",children:[Object(q.jsxs)(X.a,{fontWeight:"bold",children:["Occupancy of ",null===r||void 0===r?void 0:r.institution.parking_lots[0].name]}),Object(q.jsx)(Be.a,{type:"line",data:{labels:null===o||void 0===o?void 0:o.past_lot_occupancy.map((function(e){return"".concat(new Date(e.updated_at).getHours(),".00")})),datasets:[{label:"# of occupied spaces",data:null===o||void 0===o?void 0:o.past_lot_occupancy.map((function(e){return e.occupied})),fill:!1,backgroundColor:"rgb(255, 99, 132)",borderColor:"rgba(255, 99, 132, 0.2)"}]}})]}),Object(q.jsxs)(H.a,{direction:"column",justify:"center",spacing:16,bg:"white",p:4,boxShadow:"lg",rounded:"lg",w:"600px",children:[Object(q.jsxs)(X.a,{fontWeight:"bold",children:["Occupancy of ",null===r||void 0===r?void 0:r.institution.parking_lots[1].name]}),Object(q.jsx)(Be.a,{type:"line",data:{labels:null===c||void 0===c?void 0:c.past_lot_occupancy.map((function(e){return"".concat(new Date(e.updated_at).getHours(),".00")})),datasets:[{label:"# of occupied spaces",data:null===c||void 0===c?void 0:c.past_lot_occupancy.map((function(e){return e.occupied})),fill:!1,backgroundColor:"rgb(38, 70, 83, 0.8)",borderColor:"rgba(42, 157, 143, 0.4)"}]}})]})]})]})}var Ne=t(344),Re=t(343),We=t(190),Te=t(191);function $e(e){var n=e.path,t=e.displayName,i=e.selected,a=e.icon;return Object(q.jsxs)(Re.a,{as:Q.b,to:n,display:"flex",alignItems:"center",style:{textDecoration:"none"},rounded:"lg",px:2,transition:"all 0.1s ease-out",h:"45px",bg:i?"blue.300":"",color:i?"white":"",_hover:{background:"blue.300",color:"white"},children:[Object(q.jsx)(V.a,{as:a,mr:2,fontSize:"xl"}),t]})}function Me(){var e=Object(K.g)();return Object(q.jsxs)(G.b,{borderRight:"1px solid #ccc",children:[Object(q.jsx)(H.a,{mb:4,px:6,align:"center",h:"65px",borderBottom:"1px solid #ccc",children:Object(q.jsx)(X.a,{fontSize:"2xl",fontWeight:"bold",children:"Parkhound"})}),Object(q.jsxs)(G.b,{px:4,children:[Object(q.jsx)($e,{path:"/admin",displayName:"Dashboard",selected:"/admin"===e.pathname,icon:We.a}),Object(q.jsx)($e,{path:"/admin/lots",displayName:"Parking Lots",selected:e.pathname.includes("lot"),icon:ee.b}),Object(q.jsx)($e,{path:"/admin/drivers",displayName:"Registered Drivers",selected:e.pathname.includes("drivers"),icon:Te.a})]})]})}function Qe(e){var n=e.children;return Object(q.jsxs)(Ne.a,{templateColumns:"300px auto",h:"full",children:[Object(q.jsx)(Me,{}),Object(q.jsx)(M.a,{css:{"&::-webkit-scrollbar":{display:"none"}},overflow:"scroll",bg:"gray.50",children:n})]})}var Ke=t(5),Ye=t(36),Ge=t(347),He=t(348),Ve=t(349),Xe=t(26),Ze=t(196),Je=t(16),en=Object(R.createContext)({destinationLotId:null,destination:null,directions:null,setDestination:function(){return console.warn("No Directions Provider")},setDirections:function(){return console.warn("No Directions Provider")},setDestinationLotId:function(){return console.warn("No Directions Provider")},cancelRoute:function(){return console.warn("No Directions Provider")}});function nn(e){var n=e.children,t=Object(R.useState)(null),i=Object(Ke.a)(t,2),a=i[0],o=i[1],c=Object(R.useState)(null),r=Object(Ke.a)(c,2),l=r[0],s=r[1],d=Object(R.useState)(null),u=Object(Ke.a)(d,2),j=u[0],b=u[1],p=Object(R.useCallback)((function(){o(null),b(null),s(null)}),[o,b]);return Object(q.jsx)(en.Provider,{value:{destination:a,directions:j,destinationLotId:l,setDestination:o,setDirections:b,setDestinationLotId:s,cancelRoute:p},children:n})}var tn=function(){return Object(R.useContext)(en)},an=t(85),on=t(192);function cn(e){if(null!=e)return e<1?10*Math.round(100*e)+"m":e.toFixed(1)+"km"}function rn(e,n,t,i){var a=.017453292519943295,o=Math.cos,c=.5-o((t-e)*a)/2+o(e*a)*o(t*a)*(1-o((i-n)*a))/2;return 12742*Math.asin(Math.sqrt(c))}function ln(){var e=Object(R.useState)(""),n=Object(Ke.a)(e,2),t=n[0],i=n[1],a=Object(R.useState)(null),o=Object(Ke.a)(a,2),c=o[0],r=o[1];return Object(R.useEffect)((function(){navigator.geolocation.getCurrentPosition((function(e){i(""),r({lat:e.coords.latitude,lng:e.coords.longitude})}),(function(e){return i(e.message)}),{enableHighAccuracy:!0})}),[]),[t,c]}function sn(e){var n=e.id,t=e.address,i=e.availableSpace,a=e.capacity,o=e.location,c=ln(),r=Object(Ke.a)(c,2),l=r[0],s=r[1];return l&&console.error(l),Object(q.jsxs)(H.a,{direction:"column",p:3,h:"full",children:[Object(q.jsxs)(Ne.a,{mt:"12px",templateColumns:"1fr 1fr 1fr",placeItems:"center",children:[Object(q.jsxs)(G.b,{spacing:1,children:[Object(q.jsxs)(G.a,{children:[Object(q.jsx)(V.a,{as:an.a}),Object(q.jsx)(X.a,{fontWeight:"bold",children:"Available"})]}),Object(q.jsxs)(H.a,{align:"flex-start",children:[Object(q.jsx)(X.a,{mr:1,display:"inline-block",lineHeight:1,fontWeight:"bold",fontSize:"3xl",children:i}),Object(q.jsxs)(X.a,{color:"gray.500",display:"inline-block",children:["/",a]})]})]}),Object(q.jsxs)(G.b,{align:"center",children:[Object(q.jsxs)(G.a,{children:[Object(q.jsx)(V.a,{as:an.c}),Object(q.jsx)(X.a,{fontWeight:"bold",children:"Address"})]}),Object(q.jsx)(X.a,{children:t})]}),Object(q.jsxs)(G.b,{align:"center",children:[Object(q.jsxs)(G.a,{children:[Object(q.jsx)(V.a,{as:ee.a}),Object(q.jsx)(X.a,{fontWeight:"bold",children:"Distance"})]}),Object(q.jsx)(X.a,{children:null!=s&&null!=o&&cn(rn(null===s||void 0===s?void 0:s.lat,null===s||void 0===s?void 0:s.lng,null===o||void 0===o?void 0:o.latitude,null===o||void 0===o?void 0:o.longitude))})]})]}),Object(q.jsx)(M.a,{mt:"auto",children:Object(q.jsx)(Q.b,{to:"lot/".concat(n),children:Object(q.jsx)(Ze.a,{w:"full",size:"sm",leftIcon:Object(q.jsx)(on.a,{}),colorScheme:"blue",children:"View"})})})]})}var dn=t(346),un=t(135);function jn(e){switch(!0){case e.includes("roundabout"):return Object(q.jsx)(V.a,{as:an.b});case"turn-right"===e:return Object(q.jsx)(V.a,{as:un.b});case"turn-left"===e:return Object(q.jsx)(V.a,{as:un.a});default:return null}}function bn(){var e,n,t=tn().directions;return null==(null===t||void 0===t||null===(e=t.routes[0])||void 0===e?void 0:e.legs)?null:Object(q.jsx)(G.b,{p:4,overflowY:"scroll",spacing:4,divider:Object(q.jsx)(dn.a,{}),children:null===t||void 0===t||null===(n=t.routes[0])||void 0===n?void 0:n.legs[0].steps.map((function(e,n){return Object(q.jsx)(M.a,{children:Object(q.jsxs)(Ne.a,{templateColumns:"auto 40px",children:[Object(q.jsxs)(M.a,{children:["".concat(n+1,"."),Object(q.jsx)(M.a,{ml:1,display:"inline",dangerouslySetInnerHTML:{__html:e.instructions}})]}),Object(q.jsx)(H.a,{align:"center",justify:"center",children:jn(e.maneuver)})]})},n)}))})}function pn(e){if(null!=e)return e<1?10*Math.round(100*e)+" m":e.toFixed(1)+" km"}function gn(e){var n,t,i=e.onCardClick,a=ln(),o=Object(Ke.a)(a,2),c=o[0],r=o[1],l=(t={variables:{userLocation:{lat:(null===r||void 0===r?void 0:r.lat)||0,lng:(null===r||void 0===r?void 0:r.lng)||0}}},te.useQuery(Ce,t)).data;return c?Object(q.jsx)(X.a,{children:"Error occured"}):Object(q.jsx)(H.a,{h:"150px",children:Object(q.jsx)(G.a,{p:4,spacing:3,overflowX:"scroll",children:null===l||void 0===l||null===(n=l.nearby_spaces)||void 0===n?void 0:n.map((function(e,n){var t,a,o,c,r;return Object(q.jsxs)(H.a,{onClick:function(){var n;return i(null===e||void 0===e||null===(n=e.parking_lot)||void 0===n?void 0:n.id)},p:2,rounded:"lg",direction:"column",h:"full",minW:"175px",borderWidth:"1px",borderColor:(null===e||void 0===e||null===(t=e.parking_lot)||void 0===t||null===(a=t.vacant_space)||void 0===a?void 0:a.vacant_count)>0?"green.500":"gray.300",children:[Object(q.jsx)(X.a,{fontWeight:"bold",children:null===e||void 0===e||null===(o=e.parking_lot)||void 0===o?void 0:o.name}),Object(q.jsx)(X.a,{color:"gray.500",children:pn(null===e||void 0===e?void 0:e.distance)}),Object(q.jsxs)(M.a,{mt:"auto",children:[Object(q.jsx)(X.a,{display:"inline",mr:1,fontSize:"xl",fontWeight:"bold",children:(null===e||void 0===e||null===(c=e.parking_lot)||void 0===c||null===(r=c.vacant_space)||void 0===r?void 0:r.vacant_count)||0}),Object(q.jsx)(X.a,{display:"inline",color:"gray.500",children:"empty spaces"})]})]},n)}))})})}var hn=Object(Ye.a)(Je.b.div),fn={type:"spring",stiffness:700,damping:30};function xn(e){var n,t,i,a,o,c,r,l,s=e.selectedLot,d=e.setSelectedLot,u=e.isOpen,j=e.setIsOpen,b=tn(),p=b.directions,g=b.cancelRoute,h=Object(Je.c)(),f=function(e){var n=Object(R.useRef)();return Object(R.useEffect)((function(){n.current=e}),[e]),n.current}(u),x=W.a.useState(!1),v=Object(Ke.a)(x,2),O=v[0],_=v[1],m=W.a.useRef(null),k=(l={variables:{id:s||0}},te.useQuery(Le,l)).data;return Object(R.useEffect)((function(){f&&!u?h.start("hidden"):!f&&u&&h.start("visible")}),[h,u,f]),Object(q.jsxs)(H.a,{w:"full",h:"full",align:"flex-end",pos:"absolute",bottom:"0",left:"0",zIndex:"999",overflowY:"hidden",pointerEvents:"none",children:[Object(q.jsxs)(hn,{pointerEvents:"auto",display:"flex",flexDirection:"column",boxShadow:"xs",borderTopLeftRadius:"xl",borderTopRightRadius:"xl",bg:"white",h:"200px",w:"full",drag:"y",initial:"visible",animate:h,variants:{visible:{y:0},hidden:{y:150}},transition:fn,onDragEnd:function(e,n){n.velocity.y>20||n.velocity.y>=0&&n.point.y>45?(h.start("hidden"),j(!1)):(h.start("visible"),j(!0))},dragConstraints:{top:0},children:[Object(q.jsxs)(Ne.a,{placeItems:"center",templateColumns:"40px auto 40px",minH:"50px",borderBottom:"1px #ddd solid",children:[s?Object(q.jsx)(Ge.a,{rounded:"full",variant:"ghost","aria-label":"Go back",icon:Object(q.jsx)(Z.d,{}),onClick:function(){d(null)}}):Object(q.jsx)(He.a,{}),Object(q.jsx)(X.a,{fontWeight:"bold",align:"center",children:p?"Directions":s?null===k||void 0===k||null===(n=k.parking_lot_by_pk)||void 0===n?void 0:n.name:"Parking Lots Near You"}),p?Object(q.jsx)(Ge.a,{colorScheme:"red",rounded:"full",variant:"ghost","aria-label":"Cancel",icon:Object(q.jsx)(Z.c,{}),onClick:function(){_(!0)}}):Object(q.jsx)(He.a,{})]}),p?Object(q.jsx)(bn,{}):s?Object(q.jsx)(sn,{id:s,address:(null===k||void 0===k||null===(t=k.parking_lot_by_pk)||void 0===t?void 0:t.location.address)||"",availableSpace:(null===k||void 0===k||null===(i=k.parking_lot_by_pk)||void 0===i||null===(a=i.vacant_space)||void 0===a?void 0:a.vacant_count)||0,capacity:null===k||void 0===k||null===(o=k.parking_lot_by_pk)||void 0===o||null===(c=o.vacant_space)||void 0===c?void 0:c.capacity,location:null===k||void 0===k||null===(r=k.parking_lot_by_pk)||void 0===r?void 0:r.location}):Object(q.jsx)(gn,{onCardClick:function(e){null!=e&&d(e)}})]}),Object(q.jsx)(Ve.a,{isOpen:O,leastDestructiveRef:m,onClose:function(){return _(!1)},motionPreset:"slideInBottom",size:"sm",preserveScrollBarGap:!0,children:Object(q.jsx)(Xe.h,{children:Object(q.jsxs)(Ve.b,{mt:"auto",mb:0,children:[Object(q.jsx)(Xe.g,{fontSize:"lg",fontWeight:"bold",children:"Cancel Route"}),Object(q.jsx)(Xe.b,{children:"Do you want to cancel the current route?"}),Object(q.jsxs)(Xe.f,{children:[Object(q.jsx)(Ze.a,{ref:m,onClick:function(){return _(!1)},children:"Close"}),Object(q.jsx)(Ze.a,{colorScheme:"red",onClick:function(){g(),_(!1)},ml:3,children:"Cancel Route"})]})]})})})]})}var vn=t(25),On=t(49),_n=t(61),mn=[{featureType:"administrative.land_parcel",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"poi.business",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"labels",stylers:[{visibility:"off"}]}];function kn(e){var n=e.position;return Object(q.jsx)(_n.e,{icon:{path:0,scale:8,fillOpacity:1,strokeWeight:2,fillColor:"#5384ED",strokeColor:"#ffffff"},position:n})}function yn(e){var n=e.center,t=e.lots,i=e.onMarkerClick,a=e.children,o=e.currentPos,c=Object(R.useState)(null),r=Object(Ke.a)(c,2),l=r[0],s=r[1],d=tn().destinationLotId,u=Object(R.useMemo)((function(){return null==d?t.map((function(e,n){var t=e.id,a=e.location,o=e.vacant_space;return Object(q.jsx)(wn,{onClick:function(){return i(t)},position:{lat:a.latitude,lng:a.longitude},is_full:0===(null===o||void 0===o?void 0:o.vacant_count)||null==(null===o||void 0===o?void 0:o.vacant_count)},n)})):t.filter((function(e){return e.id===d})).map((function(e,n){var t=e.id,a=e.location;return Object(q.jsx)(wn,{onClick:function(){return i(t)},position:{lat:a.latitude,lng:a.longitude}},n)}))}),[d,t,i]);return Object(R.useEffect)((function(){null===l||void 0===l||l.panTo(n)}),[n,l]),Object(q.jsx)(_n.d,{googleMapsApiKey:"AIzaSyBblBzZWcOK-HlyENdxgIwwwid0sVmseDk",children:Object(q.jsxs)(_n.c,{onLoad:function(e){return s(e)},options:{disableDefaultUI:!0,clickableIcons:!1,styles:mn},mapContainerStyle:{width:"100vw",height:"100vh"},center:n,zoom:15,children:[Object(q.jsx)(kn,{position:o||{lat:0,lng:0}}),u,a]})})}function wn(e){var n=e.is_full,t=Object(On.a)(e,["is_full"]);return Object(q.jsx)(_n.e,Object(vn.a)({icon:{url:n?"/red_marker.svg":"parking_marker.svg",anchor:new google.maps.Point(17,46),scaledSize:new google.maps.Size(37,37)}},t))}var In=W.a.memo(yn),Sn=t(351),Cn=t(359);function Ln(){var e=Object(Sn.a)(),n=e.isOpen,t=e.onOpen,i=e.onClose,a=Object(R.useRef)(null);return Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)(M.a,{pos:"absolute",top:"0",left:"0",zIndex:"999",children:Object(q.jsx)(Ge.a,{boxShadow:"lg",ref:a,"aria-label":"drawer",onClick:t,icon:Object(q.jsx)(Z.k,{}),bg:"white",rounded:"full",height:"40px",width:"40px",mt:"20px",ml:"20px"})}),Object(q.jsx)(Cn.a,{isOpen:n,placement:"left",onClose:i,finalFocusRef:a,children:Object(q.jsx)(Xe.h,{children:Object(q.jsxs)(Cn.b,{children:[Object(q.jsx)(Xe.c,{}),Object(q.jsx)(Xe.g,{children:"Parkhound"}),Object(q.jsx)(dn.a,{}),Object(q.jsx)(Xe.b,{children:Object(q.jsxs)(G.b,{mt:4,spacing:4,children:[Object(q.jsxs)(H.a,{align:"center",children:[Object(q.jsx)(V.a,{as:Z.j,mr:2}),Object(q.jsx)(Re.a,{to:"/",as:Q.b,children:"Map"})]}),Object(q.jsxs)(H.a,{align:"center",children:[Object(q.jsx)(V.a,{as:Z.i,mr:2}),Object(q.jsx)(Re.a,{to:"/lot-list",as:Q.b,children:"Parking Lots"})]})]})}),Object(q.jsx)(Xe.f,{children:Object(q.jsx)(Ze.a,{colorScheme:"red",children:"Sign Out"})})]})})})]})}var Un=t(345);function Pn(){return Object(q.jsx)(H.a,{h:"100vh",justify:"center",align:"center",children:Object(q.jsx)(Un.a,{color:"blue.500",size:"xl",thickness:"4px",emptyColor:"gray.200"})})}function Dn(){var e=tn(),n=e.destination,t=e.directions,i=e.setDirections;return Object(q.jsxs)(q.Fragment,{children:[n&&Object(q.jsx)(_n.b,{options:{destination:n,origin:{lat:38.4548244,lng:27.1899767},travelMode:"DRIVING"},callback:function(e){null==t&&(console.log(e),i(e))}}),t&&Object(q.jsx)(_n.a,{options:{suppressMarkers:!0,directions:t}})]})}function Fn(){var e,n=ln(),t=Object(Ke.a)(n,2),i=t[0],a=t[1],o=te.useQuery(Fe,e),c=o.data,r=o.error,l=o.loading,s=Object(R.useState)(null),d=Object(Ke.a)(s,2),u=d[0],j=d[1],b=Object(R.useState)(!0),p=Object(Ke.a)(b,2),g=p[0],h=p[1],f=Object(R.useState)(null),x=Object(Ke.a)(f,2),v=x[0],O=x[1];if(""!==i||r)return Object(q.jsxs)(M.a,{children:["Error: ",i||r]});if(l||null==(null===c||void 0===c?void 0:c.parking_lot)||null==a)return Object(q.jsx)(Pn,{});return Object(q.jsxs)(M.a,{pos:"relative",children:[Object(q.jsx)(xn,{selectedLot:u,setSelectedLot:j,isOpen:g,setIsOpen:h}),a&&Object(q.jsx)(In,{currentPos:a,center:null!==v&&void 0!==v?v:a,lots:null===c||void 0===c?void 0:c.parking_lot,onMarkerClick:function(e){var n=null===c||void 0===c?void 0:c.parking_lot.find((function(n){return n.id===e}));j(e),h(!0),O({lat:(null===n||void 0===n?void 0:n.location.latitude)||0,lng:(null===n||void 0===n?void 0:n.location.longitude)||0})},children:Object(q.jsx)(Dn,{})}),Object(q.jsx)(Ln,{})]})}function En(e){var n,t,i=e.lot_name,a=e.vacant_space,o=e.children,c=e.lot_id,r=e.is_admin,l=void 0!==r&&r,s=Object(On.a)(e,["lot_name","vacant_space","children","lot_id","is_admin"]),d=Object(K.f)(),u=(t={variables:{id:parseInt(localStorage.getItem("uid"))}},te.useQuery(Se,t)),j=u.data,b=u.refetch,p=function(e){return te.useMutation(me,e)}({variables:{uid:parseInt(localStorage.getItem("uid")),parking_lot_id:c},onCompleted:function(){b()}}),g=Object(Ke.a)(p,1)[0];return Object(q.jsxs)(Ne.a,Object(vn.a)(Object(vn.a)({position:"fixed",top:"0",left:l?"300px":0},s),{},{placeItems:"center",templateColumns:"40px auto 40px",p:2,borderBottom:"1px solid #eee",bg:"white",w:l?"80%":"full",zIndex:"999",children:[Object(q.jsx)(Ge.a,{rounded:"full",variant:"ghost","aria-label":"Back button",icon:Object(q.jsx)(Z.d,{}),onClick:function(){d.goBack()}}),Object(q.jsxs)(H.a,{direction:"column",justify:"center",align:"center",children:[Object(q.jsx)(X.a,{fontWeight:"bold",children:i}),Object(q.jsxs)(H.a,{children:[o,Object(q.jsxs)(M.a,{children:[Object(q.jsx)(X.a,{mr:1,display:"inline",fontWeight:"bold",children:a}),Object(q.jsx)(X.a,{display:"inline",color:"gray.500",children:"vacant spaces"})]})]})]}),!l&&Object(q.jsx)(Ge.a,{rounded:"full",variant:"ghost","aria-label":"Favorite",icon:null!=(null===j||void 0===j||null===(n=j.user_by_pk)||void 0===n?void 0:n.favorites.find((function(e){return e.parking_lot.id===c})))?Object(q.jsx)(Z.f,{color:"red"}):Object(q.jsx)(Z.g,{}),onClick:function(){var e;null==(null===j||void 0===j||null===(e=j.user_by_pk)||void 0===e?void 0:e.favorites.find((function(e){return e.parking_lot.id===c})))&&g()}})]}))}var An=t(109);function zn(e){var n=e.message,t=e.children;return Object(q.jsxs)(H.a,{p:4,direction:"column",justify:"center",align:"center",h:"100%",children:[Object(q.jsx)(V.a,{boxSize:24,as:An.a}),Object(q.jsx)(X.a,{my:4,children:n}),t]})}function Bn(e){var n=e.space,t=(n.id,n.is_entry),i=n.is_exit,a=n.is_occupied,o=n.is_road,c=n.is_blank,r=n.space_id,l=n.is_disabled,s=n.rotation,d=e.is_down,u=e.is_selected,j=Object(On.a)(e,["space","is_down","is_selected"]);return c?Object(q.jsx)(M.a,{bg:"transparent",h:"24px",w:"48px",m:2}):o?Object(q.jsx)(M.a,{fontWeight:"bold",transform:"rotate(".concat(s,"deg)"),color:"gray.500",bg:"transparent",h:"24px",w:"48px",m:2,textAlign:"center",userSelect:"none",children:"|"}):t||i?Object(q.jsxs)(H.a,{direction:"column",justify:"center",align:"center",bg:"transparent",h:"24px",w:"48px",m:2,userSelect:"none",children:[!d&&Object(q.jsx)(V.a,{as:Z.b}),Object(q.jsx)(X.a,{fontWeight:"bold",children:t?"Entry":"Exit"}),d&&Object(q.jsx)(V.a,{as:Z.a})]}):Object(q.jsx)(H.a,Object(vn.a)(Object(vn.a)({transform:"rotate(".concat(s,"deg)")},j),{},{align:"center",justify:"center",bg:l?"red.500":a?"gray.300":"green.400",h:"24px",w:"48px",rounded:"lg",m:2,border:u?"3px solid black":"none",children:l?Object(q.jsx)(V.a,{as:Z.e}):Object(q.jsx)(X.a,{align:"center",color:a?"black":"white",fontWeight:"bold",userSelect:"none",children:r})}))}var qn=W.a.memo(Bn);function Nn(e){var n=e.lot_rows,t=e.onSpaceClick,i=e.selectedSpaceId,a=(e.scale,Object(On.a)(e,["lot_rows","onSpaceClick","selectedSpaceId","scale"])),o=Object(K.f)().location.pathname.includes("admin"),c=Object(R.useRef)(null);return Object(R.useEffect)((function(){if(null!=c&&null!=c.current&&o){var e=c.current,n={top:0,left:0,x:0,y:0},t=function(t){var i=t.clientX-n.x,a=t.clientY-n.y;e.scrollTop=n.top-a,e.scrollLeft=n.left-i,console.log(e.scrollTop)},i=function n(){e.style.cursor="grab",e.style.removeProperty("user-select"),console.log("Removing mousemove & mouseup"),document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",n)},a=function(a){e.style.cursor="grabbing",e.style.userSelect="none",n={left:e.scrollLeft,top:e.scrollTop,x:a.clientX,y:a.clientY},console.log("Adding mousemove & mouseup"),document.addEventListener("mousemove",t),document.addEventListener("mouseup",i)};return document.addEventListener("mousedown",a),function(){console.log("Unmount"),document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",i),document.removeEventListener("mousedown",a)}}}),[]),Object(q.jsx)(Ne.a,Object(vn.a)(Object(vn.a)({},a),{},{justifyContent:n[0].parking_spaces.length>10?"normal":"center",mt:o?0:"130px",ref:c,cursor:"grab",overflow:"scroll",bg:"white",border:"2px solid black",gridTemplateRows:"repeat(".concat(n.length,", ").concat(36,"px)"),gridTemplateColumns:"repeat(".concat(n[0].parking_spaces.length,", ").concat(60,"px)"),padding:"16px",h:"full",css:{"&::-webkit-scrollbar":{display:"none"}},children:n.map((function(e,n){return e.parking_spaces.map((function(a,o){return Object(q.jsx)(qn,{onClick:function(){return e=a,void(t&&t(e));var e},space:a,is_down:n<e.parking_spaces.length/2&&a.is_entry||n>e.parking_spaces.length/2&&a.is_exit,is_selected:null!=i&&i===a.id},n+""+o)}))}))}))}function Rn(e){var n=e.lot_rows,t=e.onSpaceClick,i=e.is_disabled,a=Object(On.a)(e,["lot_rows","onSpaceClick","is_disabled"]),o=Object(K.f)(),c=Object(R.useState)(null),r=Object(Ke.a)(c,2),l=r[0],s=r[1],d=Object(Je.d)(1);return i&&!o.location.pathname.includes("admin")?Object(q.jsx)(zn,{message:"Sorry, this parking lot is currently disabled",children:Object(q.jsx)(Ze.a,{onClick:function(){o.goBack()},children:"Return to map"})}):Object(q.jsx)(H.a,Object(vn.a)(Object(vn.a)({justify:"center",align:"center",h:"full",pb:o.location.pathname.includes("admin")?"150px":0},a),{},{children:Object(q.jsx)(Nn,{lot_rows:n,onSpaceClick:function(e){t&&(s(e.id),t(e))},scale:d,selectedSpaceId:l})}))}function Wn(){var e,n,t=Object(K.h)().lot_id,i=Object(K.f)(),a=tn(),o=a.setDestination,c=a.setDestinationLotId,r=Pe({variables:{id:parseInt(t||"0")}}),l=r.data;return r.loading?Object(q.jsx)(Pn,{}):null==(null===l||void 0===l||null===(e=l.parking_lot_by_pk)||void 0===e?void 0:e.lot_rows)?Object(q.jsx)(zn,{message:"Sorry, there is no map for this parking lot",children:Object(q.jsx)(Ze.a,{onClick:function(){i.goBack()},children:"Return to map"})}):Object(q.jsxs)(M.a,{pos:"relative",m:{md:"auto"},w:{md:"850px"},h:"full",overflowY:"hidden",bg:"gray.200",children:[Object(q.jsx)(En,{lot_id:null===l||void 0===l?void 0:l.parking_lot_by_pk.id,lot_name:null===l||void 0===l?void 0:l.parking_lot_by_pk.name,vacant_space:null===(n=l.parking_lot_by_pk.vacant_space)||void 0===n?void 0:n.vacant_count,position:"fixed",top:0,left:0,w:"full",zIndex:"999"}),(null===l||void 0===l?void 0:l.parking_lot_by_pk.lot_rows.length)>0?Object(q.jsx)(Rn,{is_disabled:null===l||void 0===l?void 0:l.parking_lot_by_pk.is_disabled,pb:"125px",lot_rows:null===l||void 0===l?void 0:l.parking_lot_by_pk.lot_rows}):Object(q.jsx)(zn,{message:"Sorry, there is no map for this parking lot",children:Object(q.jsx)(Ze.a,{onClick:function(){i.goBack()},children:"Return to zones"})}),Object(q.jsx)(H.a,{borderTop:"1px",borderColor:"gray.300",borderTopRadius:"6px",h:"60px",bg:"white",w:"full",pos:"fixed",bottom:0,left:0,justify:"center",align:"center",children:Object(q.jsx)(Ze.a,{rounded:"full",colorScheme:"blue",w:.5,onClick:function(){var e;if(null!=(null===l||void 0===l||null===(e=l.parking_lot_by_pk)||void 0===e?void 0:e.location)&&null!=(null===l||void 0===l?void 0:l.parking_lot_by_pk.id)){var n=l.parking_lot_by_pk.location,t=n.latitude,a=n.longitude;o({lat:t,lng:a}),c(l.parking_lot_by_pk.id),i.push("/")}},children:"Navigate"})})]})}var Tn=t(18),$n=t(356);function Mn(){var e=Object(R.useState)({firstname:"",lastname:"",email:"",password:"",rpt_password:""}),n=Object(Ke.a)(e,2),t=n[0],i=n[1];function a(e){var n=e.target.name;i(Object(vn.a)(Object(vn.a)({},t),{},Object(Tn.a)({},n,e.target.value)))}return Object(q.jsx)(M.a,{m:"50px",h:"full",children:Object(q.jsx)("form",{onSubmit:function(e){e.preventDefault(),console.log(t)},children:Object(q.jsxs)(G.b,{spacing:"3",alignItems:"center",children:[Object(q.jsxs)(Y.a,{fontSize:"5xl",children:["Park"," ",Object(q.jsx)(X.a,{color:"yellow.500",children:"hound"})]}),Object(q.jsx)(X.a,{fontSize:"lg",children:"Create an account!"}),Object(q.jsx)($n.a,{variant:"flushed",name:"firstname",onChange:a,value:t.firstname,placeholder:"First Name",size:"lg",height:"60px"}),Object(q.jsx)($n.a,{variant:"flushed",name:"lastname",onChange:a,value:t.lastname,placeholder:"Last Name",size:"lg",height:"60px"}),Object(q.jsx)($n.a,{variant:"flushed",name:"email",onChange:a,value:t.email,placeholder:"Email",size:"lg",height:"60px"}),Object(q.jsx)($n.a,{variant:"flushed",name:"password",onChange:a,value:t.password,placeholder:"Password",size:"lg",height:"60px"}),Object(q.jsx)($n.a,{variant:"flushed",name:"rpt_password",onChange:a,value:t.rpt_password,placeholder:"Repeat Password",size:"lg",height:"60px"}),Object(q.jsx)(Ze.a,{type:"submit",colorScheme:"yellow",size:"lg",children:"Sign Up"}),Object(q.jsxs)(X.a,{alignitem:"center",fontSize:"sm",children:["Already have an account?"," "," ",Object(q.jsx)(Re.a,{color:"blue.500",children:"Sign In"})," "]})]})})})}var Qn=t(355);function Kn(){var e=Object(R.useState)({email:"",password:""}),n=Object(Ke.a)(e,2),t=n[0],i=n[1];function a(e){var n=e.target.name;i(Object(vn.a)(Object(vn.a)({},t),{},Object(Tn.a)({},n,e.target.value)))}return Object(q.jsx)(M.a,{m:"90px",h:"full",children:Object(q.jsx)("form",{onSubmit:function(e){e.preventDefault(),console.log(t)},children:Object(q.jsxs)(G.b,{spacing:"3",children:[Object(q.jsxs)(Y.a,{fontSize:"5xl",children:["Park"," ",Object(q.jsx)(X.a,{color:"yellow.500",children:"hound"})]}),Object(q.jsx)(X.a,{fontSize:"lg",height:"20px",children:"Sign in to continue"}),Object(q.jsx)($n.a,{variant:"flushed",name:"email",value:t.email,onChange:a,placeholder:"Email",size:"60px",height:"90px"}),Object(q.jsx)($n.a,{variant:"flushed",name:"password",value:t.password,onChange:a,placeholder:"Password",size:"60px",height:"90px"}),Object(q.jsx)(Qn.a,{defaultIsChecked:!0,height:"100px",children:"Remember Me"}),Object(q.jsx)(Ze.a,{type:"submit",colorScheme:"yellow",size:"40px",height:"70px",children:"Sign In"}),Object(q.jsxs)(X.a,{alignitem:"center",fontSize:"sm",children:["Don't have an account?"," "," ",Object(q.jsx)(Re.a,{color:"blue.500",children:"Sign Up"})," "]})]})})})}var Yn=t(360);function Gn(){var e,n,t=(n={variables:{id:1}},te.useQuery(Ee,n)),i=t.data,a=t.error,o=Object(K.f)();return a?Object(q.jsx)(M.a,{children:a.stack}):Object(q.jsxs)(M.a,{p:4,children:[Object(q.jsx)(Y.a,{mb:4,children:"Parking Lots"}),Object(q.jsx)(G.b,{spacing:2,maxW:"600px",children:null===i||void 0===i||null===(e=i.institution_by_pk)||void 0===e?void 0:e.parking_lots.map((function(e){var n;return Object(q.jsxs)(H.a,{bg:"white",p:4,rounded:"md",boxShadow:"md",onClick:function(){o.replace("lot/"+e.id)},children:[Object(q.jsx)(Yn.a,{rounded:"md",boxSize:"75px",src:e.lot_image,fallbackSrc:"/lot_placeholder.png",mr:3}),Object(q.jsxs)(G.b,{spacing:1,w:"full",children:[Object(q.jsx)(X.a,{fontWeight:"bold",children:e.name}),Object(q.jsxs)(H.a,{children:[Object(q.jsx)(X.a,{fontWeight:"bold",mr:1,children:(null===(n=e.vacant_space)||void 0===n?void 0:n.vacant_count)||0}),Object(q.jsx)(X.a,{children:"spaces available"})]})]})]},e.id)}))})]})}var Hn=t(57),Vn=t.n(Hn),Xn=t(86),Zn=t(353);function Jn(){var e,n,t=Object(Sn.a)(),i=t.isOpen,a=t.onOpen,o=t.onClose,c=Object(K.h)().lot_id,r=Object(R.useState)(null),l=Object(Ke.a)(r,2),s=l[0],d=l[1],u=Pe({variables:{id:parseInt(c)}}),j=u.data,b=u.loading,p=(n={onCompleted:function(e){d(e.update_parking_space_by_pk)}},te.useMutation(ye,n)),g=Object(Ke.a)(p,2),h=g[0],f=g[1].loading,x=function(e){return te.useMutation(ke,e)}(),v=Object(Ke.a)(x,2),O=v[0],_=(v[1].loading,Object(R.useState)(!1)),m=Object(Ke.a)(_,2),k=m[0],y=m[1];return b?Object(q.jsx)(Pn,{}):null==(null===j||void 0===j?void 0:j.parking_lot_by_pk)||0===(null===j||void 0===j?void 0:j.parking_lot_by_pk.lot_rows.length)?Object(q.jsx)(M.a,{children:"Error. No Lot Data"}):Object(q.jsxs)(M.a,{pos:"relative",pt:"65px",h:"full",children:[Object(q.jsx)(En,{lot_id:null===j||void 0===j?void 0:j.parking_lot_by_pk.id,is_admin:!0,lot_name:null===j||void 0===j?void 0:j.parking_lot_by_pk.name,vacant_space:null===(e=j.parking_lot_by_pk.vacant_space)||void 0===e?void 0:e.vacant_count,bg:"white",children:j.parking_lot_by_pk.is_disabled&&Object(q.jsx)(X.a,{fontWeight:"bold",mr:2,children:"DISABLED -"})}),Object(q.jsx)(Rn,{is_disabled:null===j||void 0===j?void 0:j.parking_lot_by_pk.is_disabled,onSpaceClick:function(e){d(e)},lot_rows:null===j||void 0===j?void 0:j.parking_lot_by_pk.lot_rows}),Object(q.jsxs)(H.a,{pos:"fixed",bottom:0,w:"1620px",h:"150px",bg:"white",p:4,borderTop:"1px solid #ccc",children:[Object(q.jsxs)(H.a,{children:[Object(q.jsxs)(H.a,{direction:"column",children:[Object(q.jsx)(X.a,{fontSize:"lg",fontWeight:"bold",children:"Lot Actions"}),Object(q.jsx)(G.a,{mt:4,children:j.parking_lot_by_pk.is_disabled?Object(q.jsx)(Ze.a,{colorScheme:"green",onClick:Object(Xn.a)(Vn.a.mark((function e(){return Vn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O({variables:{id:parseInt(c),_set:{is_disabled:!1}}});case 1:case"end":return e.stop()}}),e)}))),children:"Enable Lot"}):Object(q.jsx)(Ze.a,{onClick:Object(Xn.a)(Vn.a.mark((function e(){return Vn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O({variables:{id:parseInt(c),_set:{is_disabled:!0}}});case 1:case"end":return e.stop()}}),e)}))),children:"Disable Lot"})})]}),Object(q.jsx)(Zn.a,{w:"32px",children:Object(q.jsx)(dn.a,{orientation:"vertical"})}),s?Object(q.jsxs)(H.a,{direction:"column",children:[Object(q.jsxs)(X.a,{fontSize:"lg",fontWeight:"bold",children:["Parking Space ",null===s||void 0===s?void 0:s.space_id]}),Object(q.jsx)(G.a,{mt:4,children:s.is_disabled?Object(q.jsx)(Ze.a,{colorScheme:"green",isLoading:f,onClick:Object(Xn.a)(Vn.a.mark((function e(){return Vn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h({variables:{id:s.id,_set:{is_disabled:!1}}});case 2:case"end":return e.stop()}}),e)}))),children:"Enable Space"}):Object(q.jsx)(Ze.a,{isLoading:f,onClick:Object(Xn.a)(Vn.a.mark((function e(){return Vn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h({variables:{id:s.id,_set:{is_disabled:!0}}});case 2:case"end":return e.stop()}}),e)}))),children:"Disable Space"})})]}):Object(q.jsx)(M.a,{w:"142px"})]}),Object(q.jsxs)(H.a,{ml:"auto",direction:"column",textAlign:"end",children:[Object(q.jsx)(X.a,{fontSize:"lg",fontWeight:"bold",children:"View Latest Image"}),Object(q.jsx)(G.a,{mt:4,justify:"flex-end",children:Object(q.jsx)(Ze.a,{onClick:a,colorScheme:"blue",leftIcon:Object(q.jsx)(Z.h,{}),children:"View"})})]})]}),Object(q.jsxs)(Xe.a,{size:"5xl",isOpen:i,onClose:o,children:[Object(q.jsx)(Xe.h,{}),Object(q.jsxs)(Xe.d,{children:[Object(q.jsx)(Xe.g,{children:"Latest Lot Image"}),Object(q.jsx)(Xe.c,{}),Object(q.jsx)(Xe.b,{children:k?Object(q.jsx)(Yn.a,{w:"1280px",h:"720px",src:"/".concat(c,"/processed.jpg")}):Object(q.jsx)(Yn.a,{w:"1280px",h:"720px",src:"/".concat(c,"/latest.jpg")})}),Object(q.jsx)(Xe.f,{children:Object(q.jsx)(Ze.a,{onClick:function(){return y(!k)},children:k?"Show original":"Show processed"})})]})]})]})}function et(){var e,n,t,i=Object(K.f)(),a=ln(),o=Object(Ke.a)(a,2),c=(o[0],o[1]),r=(t={variables:{uid:parseInt(localStorage.getItem("uid")),userLocation:{lat:(null===c||void 0===c?void 0:c.lat)||0,lng:(null===c||void 0===c?void 0:c.lng)||0}}},te.useQuery(De,t)).data;return 0===(null===r||void 0===r||null===(e=r.nearby_spaces)||void 0===e?void 0:e.length)?Object(q.jsx)(M.a,{children:"No lots"}):Object(q.jsxs)(M.a,{p:4,h:"full",children:[Object(q.jsxs)(H.a,{mb:4,align:"center",children:[Object(q.jsx)(Ge.a,{mr:1,variant:"ghost","aria-label":"Go Back",icon:Object(q.jsx)(Z.d,{}),onClick:function(){return i.goBack()}}),Object(q.jsx)(Y.a,{children:"Parking Lots"})]}),Object(q.jsx)(G.b,{children:null===r||void 0===r||null===(n=r.nearby_spaces)||void 0===n?void 0:n.map((function(e,n){var t,a,o,c;return Object(q.jsxs)(H.a,{bg:"white",p:4,rounded:"md",boxShadow:"md",onClick:function(){var n;i.push("/lot/"+(null===e||void 0===e||null===(n=e.parking_lot)||void 0===n?void 0:n.id))},children:[Object(q.jsx)(Yn.a,{rounded:"md",boxSize:"75px",src:null===e||void 0===e||null===(t=e.parking_lot)||void 0===t?void 0:t.lot_image,fallbackSrc:"/lot_placeholder.png",mr:3}),Object(q.jsxs)(G.b,{spacing:1,w:"full",children:[Object(q.jsx)(X.a,{fontWeight:"bold",children:null===e||void 0===e||null===(a=e.parking_lot)||void 0===a?void 0:a.name}),Object(q.jsxs)(H.a,{children:[Object(q.jsx)(X.a,{fontWeight:"bold",mr:1,children:(null===e||void 0===e||null===(o=e.parking_lot)||void 0===o||null===(c=o.vacant_space)||void 0===c?void 0:c.vacant_count)||0}),Object(q.jsx)(X.a,{children:"spaces available"})]}),Object(q.jsx)(H.a,{justify:"flex-end",children:Object(q.jsx)(X.a,{fontWeight:"bold",children:cn(null===e||void 0===e?void 0:e.distance)})})]})]},n)}))})]})}function nt(){var e,n,t=(n={variables:{id:1}},te.useQuery(Ie,n)).data;return Object(q.jsxs)(M.a,{p:4,children:[Object(q.jsx)(Y.a,{mb:4,children:"Drivers"}),Object(q.jsxs)(Ne.a,{placeItems:"center",children:[Object(q.jsxs)(H.a,{color:"gray.500",px:4,py:2,w:"800px",children:[Object(q.jsx)(M.a,{width:"250px",children:"Name"}),Object(q.jsx)(M.a,{width:"250px",children:"Email"}),Object(q.jsx)(M.a,{width:"250px",children:"Role"}),Object(q.jsx)(M.a,{width:"250px",children:"Actions"})]}),null===t||void 0===t||null===(e=t.institution_by_pk)||void 0===e?void 0:e.user_institutions.map((function(e){var n=e.user,t=e.is_admin,i=e.user_id;return Object(q.jsxs)(H.a,{p:8,align:"center",bg:"white",w:"800px",h:"50px",border:"1px solid #ccc",children:[Object(q.jsxs)(M.a,{width:"250px",children:[n.first_name," ",n.last_name]}),Object(q.jsx)(M.a,{width:"250px",children:n.email}),Object(q.jsx)(M.a,{width:"250px",children:t?"Admin":"Driver"}),Object(q.jsxs)(M.a,{width:"250px",children:[!t&&Object(q.jsx)(Ge.a,{colorScheme:"yellow",mr:2,"aria-label":"Promote",icon:Object(q.jsx)(J.a,{})}),Object(q.jsx)(Ge.a,{colorScheme:"red","aria-label":"Ban",icon:Object(q.jsx)(An.b,{})})]})]},i)}))]})]})}function tt(){return Object(q.jsx)(M.a,{h:"100vh",children:Object(q.jsx)(Q.a,{children:Object(q.jsxs)(K.c,{children:[Object(q.jsx)(K.a,{path:"/lot/:lot_id",children:Object(q.jsx)(Wn,{})}),Object(q.jsx)(K.a,{path:"/lot-list",children:Object(q.jsx)(et,{})}),Object(q.jsx)(K.a,{path:"/admin/lot/:lot_id",children:Object(q.jsx)(Qe,{children:Object(q.jsx)(Jn,{})})}),Object(q.jsx)(K.a,{path:"/admin/lots",children:Object(q.jsx)(Qe,{children:Object(q.jsx)(Gn,{})})}),Object(q.jsx)(K.a,{path:"/admin/drivers",children:Object(q.jsx)(Qe,{children:Object(q.jsx)(nt,{})})}),Object(q.jsx)(K.a,{exact:!0,path:"/admin",children:Object(q.jsx)(Qe,{children:Object(q.jsx)(qe,{})})}),Object(q.jsx)(K.a,{path:"/register",children:Object(q.jsx)(Mn,{})}),Object(q.jsx)(K.a,{path:"/login",children:Object(q.jsx)(Kn,{})}),Object(q.jsx)(K.a,{exact:!0,path:"/",children:Object(q.jsx)(Fn,{})})]})})})}var it=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,361)).then((function(n){var t=n.getCLS,i=n.getFID,a=n.getFCP,o=n.getLCP,c=n.getTTFB;t(e),i(e),a(e),o(e),c(e)}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var at=t(354),ot=t(48),ct=function(){return Object(q.jsx)(ot.a,{styles:"\n      /* latin-ext */\n      @font-face {\n        font-family: 'Open Sans';\n        font-style: normal;\n        font-weight: 700;\n        font-display: swap;\n        src: url(https://fonts.gstatic.com/s/opensans/v18/mem5YaGs126MiZpBA-UN7rgOXOhpKKSTj5PW.woff2) format('woff2');\n        unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;\n      }\n      /* latin */\n      @font-face {\n        font-family: 'Open Sans';\n        font-style: normal;\n        font-weight: 700;\n        font-display: swap;\n        src: url(https://fonts.gstatic.com/s/opensans/v18/mem5YaGs126MiZpBA-UN7rgOUuhpKKSTjw.woff2) format('woff2');\n        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;\n      }\n      /* latin-ext */\n      @font-face {\n        font-family: 'PT Sans';\n        font-style: normal;\n        font-weight: 400;\n        font-display: swap;\n        src: url(https://fonts.gstatic.com/s/ptsans/v12/jizaRExUiTo99u79D0yExdGM.woff2) format('woff2');\n        unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;\n      }\n      /* latin */\n      @font-face {\n        font-family: 'PT Sans';\n        font-style: normal;\n        font-weight: 400;\n        font-display: swap;\n        src: url(https://fonts.gstatic.com/s/ptsans/v12/jizaRExUiTo99u79D0KExQ.woff2) format('woff2');\n        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;\n      }\n      "})},rt=new te.ApolloClient({uri:"http://localhost:8080/v1/graphql",cache:new te.InMemoryCache});localStorage.setItem("uid","1"),console.log("Current user is 1");var lt=Object(at.a)({fonts:{heading:"Open Sans",body:"PT Sans"}});$.a.render(Object(q.jsx)(R.StrictMode,{children:Object(q.jsx)(te.ApolloProvider,{client:rt,children:Object(q.jsxs)(N.a,{theme:lt,children:[Object(q.jsx)(ct,{}),Object(q.jsx)(nn,{children:Object(q.jsx)(tt,{})})]})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),it()}},[[326,1,2]]]);
//# sourceMappingURL=main.e9d9bbec.chunk.js.map